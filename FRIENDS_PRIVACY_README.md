# Friend Request & Advanced Privacy System\n\n## Overview\nএই ফিচারটি Facebook এর মতো সম্পূর্ণ Friend Request, Notification, এবং Advanced Privacy system implement করে।\n\n## Features Implemented\n\n### 1. Friend Request System\n- **Send Friend Request**: বন্ধু অনুরোধ পাঠানো\n- **Accept/Reject Requests**: অনুরোধ গ্রহণ/প্রত্যাখ্যান\n- **Cancel Sent Requests**: পাঠানো অনুরোধ বাতিল\n- **Friend Suggestions**: বন্ধুদের বন্ধুদের ভিত্তিতে পরামর্শ\n- **Mutual Friends Count**: সাধারণ বন্ধুর সংখ্যা দেখানো\n\n### 2. Real-time Notification System\n- **Like Notifications**: কেউ লাইক দিলে notification\n- **Comment Notifications**: কেউ কমেন্ট করলে notification\n- **Share Notifications**: কেউ শেয়ার করলে notification\n- **Friend Request Notifications**: বন্ধু অনুরোধ এলে notification\n- **Friend Accept Notifications**: অনুরোধ গ্রহণ হলে notification\n- **Real-time Updates**: Socket.io দিয়ে instant notification\n\n### 3. Advanced Privacy Settings\n#### Post Privacy\n- **Default Visibility**: Public, Friends, Only Me\n- **Comment Permissions**: কে কমেন্ট করতে পারবে\n- **Share Permissions**: কে শেয়ার করতে পারবে\n- **Reaction Permissions**: কে রিয়্যাক্ট করতে পারবে\n\n#### Profile Privacy\n- **Basic Info Visibility**: মৌলিক তথ্য দৃশ্যমানতা\n- **Contact Info Visibility**: যোগাযোগের তথ্য দৃশ্যমানতা\n- **Friends List Visibility**: বন্ধু তালিকা দৃশ্যমানতা\n- **Photos Visibility**: ছবি দৃশ্যমানতা\n\n#### Friend Request Settings\n- **Who Can Send**: কে বন্ধু অনুরোধ পাঠাতে পারবে\n- **Friends List Visibility**: বন্ধু তালিকা কে দেখতে পারবে\n\n#### Messaging Settings\n- **Who Can Message**: কে মেসেজ পাঠাতে পারবে\n- **Message Requests**: অজানা লোকের মেসেজ গ্রহণ\n\n#### User Management\n- **Block Users**: ব্যবহারকারী ব্লক করা\n- **Restrict Users**: ব্যবহারকারী রেস্ট্রিক্ট করা\n- **Custom Lists**: কাস্টম বন্ধু তালিকা তৈরি\n\n#### Activity Status\n- **Online Status**: অনলাইন স্ট্যাটাস দেখানো\n- **Last Seen**: শেষ দেখা সময় দেখানো\n\n## Technical Implementation\n\n### Backend Models\n\n#### FriendRequest Model\n```javascript\n{\n  sender: ObjectId,\n  receiver: ObjectId,\n  status: 'pending' | 'accepted' | 'rejected' | 'cancelled',\n  message: String,\n  createdAt: Date,\n  updatedAt: Date\n}\n```\n\n#### Notification Model\n```javascript\n{\n  recipient: ObjectId,\n  sender: ObjectId,\n  type: 'like' | 'comment' | 'share' | 'friend_request' | etc,\n  entityType: 'post' | 'comment' | 'user' | etc,\n  entityId: ObjectId,\n  message: String,\n  isRead: Boolean,\n  metadata: Map,\n  createdAt: Date\n}\n```\n\n#### PrivacySetting Model\n```javascript\n{\n  user: ObjectId,\n  postVisibility: {\n    default: 'public' | 'friends' | 'only_me',\n    allowComments: 'everyone' | 'friends' | 'no_one',\n    allowShares: 'everyone' | 'friends' | 'no_one',\n    allowReactions: 'everyone' | 'friends' | 'no_one'\n  },\n  profileVisibility: {\n    basicInfo: 'public' | 'friends' | 'only_me',\n    contactInfo: 'public' | 'friends' | 'only_me',\n    friendsList: 'public' | 'friends' | 'only_me',\n    photos: 'public' | 'friends' | 'only_me'\n  },\n  // ... more settings\n}\n```\n\n### API Endpoints\n\n#### Friend Request APIs\n- `POST /api/friends/send` - বন্ধু অনুরোধ পাঠানো\n- `PUT /api/friends/accept/:requestId` - অনুরোধ গ্রহণ\n- `PUT /api/friends/reject/:requestId` - অনুরোধ প্রত্যাখ্যান\n- `DELETE /api/friends/cancel/:requestId` - অনুরোধ বাতিল\n- `GET /api/friends/pending` - প্রাপ্ত অনুরোধ\n- `GET /api/friends/sent` - পাঠানো অনুরোধ\n- `GET /api/friends/suggestions` - বন্ধু পরামর্শ\n- `GET /api/friends/list` - বন্ধু তালিকা\n- `DELETE /api/friends/remove/:friendId` - বন্ধু সরানো\n\n#### Notification APIs\n- `GET /api/notifications` - সব notification\n- `PUT /api/notifications/read/:id` - পড়া হিসাবে চিহ্নিত\n- `PUT /api/notifications/read-all` - সব পড়া হিসাবে চিহ্নিত\n- `DELETE /api/notifications/:id` - notification ডিলিট\n- `GET /api/notifications/unread-count` - অপঠিত সংখ্যা\n\n#### Privacy APIs\n- `GET /api/privacy` - privacy settings\n- `PUT /api/privacy` - settings আপডেট\n- `PUT /api/privacy/posts` - post privacy আপডেট\n- `PUT /api/privacy/profile` - profile privacy আপডেট\n- `POST /api/privacy/block` - ব্যবহারকারী ব্লক\n- `POST /api/privacy/unblock` - আনব্লক\n- `POST /api/privacy/restrict` - রেস্ট্রিক্ট\n- `GET /api/privacy/blocked` - ব্লক করা তালিকা\n\n### Real-time Features (Socket.io)\n\n#### Socket Events\n```javascript\n// Client to Server\nsocket.emit('join_room', { roomId });\nsocket.emit('typing_start', { chatId });\nsocket.emit('friend_request_sent', { receiverId });\n\n// Server to Client\nsocket.on('new_notification', notification => {});\nsocket.on('friend_request_received', data => {});\nsocket.on('user_online', userId => {});\nsocket.on('user_offline', userId => {});\n```\n\n### Frontend Components\n\n#### Main Components\n1. **FriendRequests.js** - বন্ধু অনুরোধ ব্যবস্থাপনা\n2. **FriendsList.js** - বন্ধু তালিকা\n3. **NotificationCenter.js** - notification center\n4. **PrivacySettings.js** - privacy settings\n5. **FriendsPage.js** - সব components একসাথে\n\n#### Key Features\n- Material-UI দিয়ে responsive design\n- Real-time updates\n- Bengali language support\n- Infinite scrolling\n- Search functionality\n- Batch operations\n\n### Context Providers\n\n#### SocketContext\n- Socket.io connection management\n- Real-time event handling\n- Online user tracking\n- Helper functions for common events\n\n## Usage Instructions\n\n### Setup\n1. Backend এ নতুন routes import করুন server.js এ\n2. Frontend এ SocketProvider wrap করুন App component এ\n3. FriendsPage component কে routing এ add করুন\n\n### Environment Variables\nকোনো নতুন environment variable প্রয়োজন নেই।\n\n### Database Migration\nনতুন models automatically create হবে প্রথম run এ।\n\n## Security Features\n\n### Data Protection\n- JWT authentication সব API এ\n- Input validation\n- XSS protection\n- Rate limiting (implement করা যেতে পারে)\n\n### Privacy Controls\n- Granular privacy settings\n- User blocking/restricting\n- Permission checking middleware\n- Real-time permission updates\n\n## Performance Optimizations\n\n### Database\n- Proper indexing সব models এ\n- Pagination সব list APIs এ\n- Aggregation pipeline complex queries এর জন্য\n\n### Frontend\n- Lazy loading components\n- Memoization expensive operations এর জন্য\n- Infinite scrolling\n- Debounced search\n\n## Testing\n\n### Manual Testing\n1. বিভিন্ন user দিয়ে friend request পাঠান\n2. Real-time notification check করুন\n3. Privacy settings test করুন\n4. Block/unblock functionality test করুন\n\n## Future Enhancements\n\n### Possible Features\n1. **Advanced Notification Filters**: notification type filter\n2. **Notification Sounds**: custom sound alerts\n3. **Email Notifications**: email এ notification পাঠানো\n4. **Push Notifications**: browser push notifications\n5. **Friend Lists Management**: close friends, acquaintances etc\n6. **Activity Log**: সব privacy related activities log\n7. **Two-Factor Authentication**: enhanced security\n\n## Troubleshooting\n\n### Common Issues\n1. **Socket not connecting**: Check CORS settings\n2. **Notifications not real-time**: Verify socket connection\n3. **Privacy settings not saving**: Check authentication\n4. **Friend suggestions not showing**: Check aggregation pipeline\n\n### Debug Tips\n- Console logs আছে সব important functions এ\n- Browser developer tools দিয়ে socket events monitor করুন\n- Network tab দিয়ে API calls check করুন\n\n## Files Created/Modified\n\n### Backend Files\n- `models/FriendRequest.js` - নতুন\n- `models/Notification.js` - নতুন\n- `models/PrivacySetting.js` - নতুন\n- `routes/friends.js` - নতুন\n- `routes/notifications.js` - নতুন\n- `routes/privacy.js` - নতুন\n- `socket/socketManager.js` - নতুন\n- `server.js` - আপডেট করা\n- `routes/posts.js` - আপডেট করা\n\n### Frontend Files\n- `client/src/components/Friends/FriendRequests.js` - নতুন\n- `client/src/components/Friends/FriendsList.js` - নতুন\n- `client/src/components/Notifications/NotificationCenter.js` - নতুন\n- `client/src/components/Privacy/PrivacySettings.js` - নতুন\n- `client/src/contexts/SocketContext.js` - নতুন\n- `client/src/api/friends.js` - নতুন\n- `client/src/pages/FriendsPage.js` - নতুন\n\nএই implementation সম্পূর্ণ Facebook-like friend request এবং privacy system প্রদান করে real-time notifications এর সাথে।